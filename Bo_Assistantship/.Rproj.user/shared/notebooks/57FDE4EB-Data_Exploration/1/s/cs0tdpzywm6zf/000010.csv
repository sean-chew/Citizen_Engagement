"0","# DEP_points_all <- DEP_Query %>%"
"0","#   select(c(""unique_key"","
"0","#            ""complaint_type"","
"0","#            ""created_date"","
"0","#            ""x_coordinate_state_plane"","
"0","#            ""y_coordinate_state_plane"")) %>%"
"0","#   drop_na() %>%"
"0","#   st_as_sf(coords = c(""x_coordinate_state_plane"",""y_coordinate_state_plane""),"
"0","#            crs = 2263) %>%"
"0","#   mutate(year = year(created_date))"
"0","# "
"0","# saveRDS(DEP_points_all,""../3_Intermediate/DEP_points_all.rds"")"
"0",""
"0","## We can use a smaller test sample size to see if our visualization is working:"
"0",""
"0","# DEP_points <- read_rds(""../3_Intermediate/DEP_points.rds"")"
"0",""
"0","years = c(2020:2010)"
"0","view_complaints = map_complaints"
"0","## Spatial Joins. These take extremely long, so saving for optimizing for time."
"0",""
"0","# ct_complaints_all_1 <- ct %>%"
"0","#   st_intersection(DEP_points_all) %>%"
"0","#   group_by(ct2010,boro_name) %>%"
"0","#   count()"
"0","#  "
"0","# saveRDS(ct_complaints_all_1,""../3_Intermediate/ct_complaints_all_1.rds"")"
"0",""
"0","ct_complaints_all_1 <- read_rds(""../3_Intermediate/ct_complaints_all_1.rds"")"
"0","# Filter data to what inputs we want."
"0",""
"0","proportion_DEP <- map(filtered_ct_all,join_shapes)"
"0","proportion_input <- list(proportion_DEP,map_complaints)"
"0","proportion_DEP_all <- pmap(proportion_input,plotting_perDEP)"
"0","proportion_DEP_all"
"1","[[1]]
"
"1","
"
"1","[[2]]
"
"1","
"
"1","[[3]]
"
"1","
"
